<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Optokinetischer Effekt - WebXR Polyfill</title>
    <!-- WebXR Polyfill für verbesserte VR-Unterstützung -->
    <script src="https://cdn.jsdelivr.net/npm/webxr-polyfill@latest/build/webxr-polyfill.min.js"></script>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  </head>
  <body>
    <!-- A-Frame Szene mit WebXR-Unterstützung -->
    <a-scene vr-mode-ui="enabled: true" renderer="antialias: true;">
      <!-- Kamera und Bewegung -->
      <a-entity id="cameraRig" position="0 1.6 0" wasd-controls="acceleration: 50" look-controls="pointerLockEnabled: true">
        <a-camera></a-camera>
      </a-entity>

      <!-- Schwarzer Hintergrund -->
      <a-sky color="#000000"></a-sky>

      <!-- Weiße Punkte auf großer Kugel -->
      <a-entity id="points-group">
        <!-- Punkte werden durch JavaScript hinzugefügt -->
      </a-entity>

      <!-- Animationsskript -->
      <script>
        // Anzahl der Punkte, Größe der Kugel und Geschwindigkeit der Rotation
        let numberOfPoints = 1000;
        let radius = 10;
        let speed = 0.005;

        // Funktion, um die Punkte in einem gleichmäßigen Raster zu erzeugen
        function createPoints() {
          let pointsGroup = document.getElementById('points-group');
          
          let steps = Math.floor(Math.sqrt(numberOfPoints));
          
          for (let i = 0; i < steps; i++) {
            let theta = (i / steps) * Math.PI * 2;

            for (let j = 0; j < steps; j++) {
              let phi = (j / steps) * Math.PI;

              let point = document.createElement('a-sphere');
              point.setAttribute('radius', 0.03);
              point.setAttribute('color', '#FFFFFF');
              
              let x = radius * Math.sin(phi) * Math.cos(theta);
              let y = radius * Math.cos(phi);
              let z = radius * Math.sin(phi) * Math.sin(theta);
              
              point.setAttribute('position', `${x} ${y} ${z}`);
              point.setAttribute('theta', theta);
              point.setAttribute('phi', phi);

              pointsGroup.appendChild(point);
            }
          }
        }

        function rotatePoints() {
          let points = document.querySelectorAll('a-sphere');
          
          points.forEach((point) => {
            let theta = parseFloat(point.getAttribute('theta'));
            let phi = parseFloat(point.getAttribute('phi'));
            
            theta += speed;
            point.setAttribute('theta', theta);
            
            let x = radius * Math.sin(phi) * Math.cos(theta);
            let y = radius * Math.cos(phi);
            let z = radius * Math.sin(phi) * Math.sin(theta);
            
            point.setAttribute('position', `${x} ${y} ${z}`);
          });
          
          requestAnimationFrame(rotatePoints);
        }

        createPoints();
        rotatePoints();
      </script>
    </a-scene>
  </body>
</html>